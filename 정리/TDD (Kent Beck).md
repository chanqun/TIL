## 테스트 주도 개발

clean code that works

- 예측 가능한 개발 방법이다. 끊임없이 발생할 버그에 대해 걱정하지 않고, 일이 언제 마무리될지 알 수 있다.
- 코드가 가르쳐주는 모든 교훈을 학습할 기회를 갖게 된다. 처음 생각나는 대로 후딱 완료해 버리면 두 번째 것, 더 나은 것에 대해 생각할 기회를 잃게 된다.
- 당신이 만든 소프트웨어는 사용자의 삶을 향상시켜 준다.
- 동료들이 당신을 존경할 수 있게 해주며, 당신 또한 동료들을 존경할 수 있게 된다.
- 작성하는 동안 기분이 좋다.


1. 빨강 - 실패하는 작은 테스트를 작성한다. 처음에는 컴파일조차 되지 않을 수 있다.
2. 초록 - 빨리 테스트가 통과하게끔 만든다. 이를 위해 어떤 죄악을 저질러도 좋다.
3. 리팩토링 - 일단 테스트를 통과하게만 하는 와중에 생겨난 모든 중복을 제거한다.

순수하게 TDD로만 풀어낼 수는 없는 프로그래밍 작업도 있다. 동시성

와이캐시 달러에서 화폐를 추가 PolyCurrency 추가 후 테스트 코드를 추가하여 성공하는지 확인

- 방법 -> 워드와 와이캐시 팀은 설계를 조금씩 성장시키는 지속적 경험이 필요했음
- 동기 -> 워드와 그의 팀은 와이캐시를 다중 통화로 만드는 것의 비즈니스적 중요성을 분명히 이해, 외적으로 불가능해 보이는 작업을 시작할 용기가 있어야 했음
- 기회 -> 포괄적이고 자신감을 만들어 내는 테스트들, 잘 리팩토링된 프로그램, 설계 결정을 분리할 수 있는 프로그래밍 언어 등의 조합을 통해 에러의 요인이 거의 없었고, 설사 있더라도 에러를 손쉽게 파악할 수
  있었다.

- 어떤 코드건 작성하기 전에 실패하는 자동화된 테스트들 작성
- 중복을 제거

### 1부 화폐 예제

TDD 리듬

1. 재빨리 테스트를 하나 추가한다.
2. 모든 테스트를 실행하고 새로 추가한 것이 실패하는지 확인한다.
3. 코드를 조금 바꾼다.
4. 모든 테스트를 실행하고 전부 성공하는지 확인한다.
5. 리팩토링을 통해 중복을 제거한다.

#### 1장. 다중 통화를 지원하는 Money 객체

- 통화가 다른 두 금액을 더해서 주어진 환율에 맞게 변한 금액을 결과로 얻을 수 있어야 한다.
- 어떤 금액을 어떤 수에 곱한 금액을 결과로 얻을 수 있어야한다.

테스트를 실패하기 위한 최소한의 작업만 진행

의존성과 중복 - 의존성은 소프트웨어 개발의 모든 부분에서 핵심적인 문제 벤더가 제공하는 세세한 기능들을 코드 여기저기에서 사용한다면 중복이 많다면 중복된 로직을 하나로 끄집어내는 객체를 이용하는 것이 좋다.

- 우리가 알고 있는 작업해야 할 테스트 목록을 만들기
- 오퍼레이션이 외부에서 어떻게 보이길 원하는지 말해주는 이야기를 코드로 표현
- 스텁 구현을 통해 테스트를 컴파일
- 돌아가는 코드에서 상수를 변수로 변경하여 점진적으로 일반화
- 새로운 할일들을 한번에 처리하는 대한 할일 목록에 추가

#### 2장 타락한 객체

1. 테스트를 작성
2. 실행 가능하게 만듬
3. 올바르게 만듬

작동하는 깔끔한 코드를 만들어야한다.

분할 정복으로 - 작동하는 -> 깔끔한 코드로 만듬

#### 3장 모두를 위한 평등

값 객체 패턴 - 객체의 인스턴스 변수가 생성자를 통해서 일단 설정된 후에는 결코 변하지 않는다.

삼각측량을 이용

#### 4장 프라이버시

```java
public void testMultiPlication() {
        Dollar five = new Dollar(5);
        assertEquals(new Dollar(10),five.times(2))
        assertEquals(new Dollar(15),five.times(3))
}
```

테스트를 고치니 amount는 private 로 변경되도 괜찮다.

- 오직 테스트를 향상시키기 위해서만 개발된 기능을 사용
- 두 테스트가 동시에 실패하면 망한다는 점을 인식
- 위험 요소가 있음에도 진행
- 테스트와 코드 사이의 결합도를 낮추기 위해, 테스트하는 객체의 새 기능을 이용


#### 5장 솔직히 말하자면
Franc 만들기

#### 6장 돌아온 모두를 위한 평등

리팩토링하면서 실수했는데도 불구하고 테스트가 여전히 통과한다면 있으면 좋을 것 같은 테스트를 추가한다.

- 공통된 코드를 Dollar에서 Money로 옮김
- Franc도 Money하위 클래스로 만듬
- 불필요한 equals() 구현 일치

#### 7장 사과와 오렌지

#### 8장 객체 만들기
Money 에 Dollar를 반환하는 팩토리 메소드를 도입할 수 있음

- 동일한 메서드의 두 변이형 메서드 서명부를 통일시킴으로써 중복 제거
- 최소한 메서드 선언부만이라도 공통 상위 클래스로 옮김
- 팩토리 메서드를 도입하여 테스트 코드에서 콘크리트 하위 클래스의 존재 사실을 분리
- 하위 클래스가 사라지면 몇몇 테스트는 불필요한 여분의 것이 된다

